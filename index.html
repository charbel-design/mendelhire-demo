<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MendelHire - Proof-First Hiring Platform</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; font-family: 'Inter', sans-serif; background: #0a1628; color: #f0f4f8; }
    #app { display: flex; height: 100vh; overflow: hidden; }
    .sidebar { width: 240px; background: #111d2e; border-right: 1px solid #1e2d3d; display: flex; flex-direction: column; transition: width 0.3s ease; z-index: 100; }
    .sidebar.collapsed { width: 64px; }
    .sidebar-top { padding: 20px; border-bottom: 1px solid #1e2d3d; }
    .sidebar.collapsed .sidebar-top { padding: 16px; display: flex; align-items: center; justify-content: center; }
    .logo { font-size: 18px; font-weight: 700; color: #3b82f6; letter-spacing: -0.5px; }
    .sidebar.collapsed .logo { font-size: 24px; }
    .nav { flex: 1; padding: 20px 0; display: flex; flex-direction: column; gap: 4px; }
    .sidebar.collapsed .nav { padding: 16px 0; align-items: center; }
    .nav-item { padding: 12px 16px; color: #8899a6; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 12px; border-left: 3px solid transparent; font-size: 14px; font-weight: 500; }
    .sidebar.collapsed .nav-item { padding: 12px; justify-content: center; gap: 0; border-left: none; }
    .nav-item:hover { color: #f0f4f8; background: rgba(59, 130, 246, 0.1); }
    .nav-item.active { color: #3b82f6; border-left-color: #3b82f6; background: rgba(59, 130, 246, 0.1); }
    .sidebar.collapsed .nav-item.active { border-left: none; background: rgba(59, 130, 246, 0.15); }
    .nav-icon { width: 20px; text-align: center; flex-shrink: 0; }
    .sidebar.collapsed .nav-text { display: none; }
    .sidebar-bottom { padding: 16px; border-top: 1px solid #1e2d3d; display: flex; align-items: center; gap: 12px; }
    .sidebar.collapsed .sidebar-bottom { flex-direction: column; gap: 8px; }
    .user-avatar { width: 40px; height: 40px; border-radius: 8px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px; flex-shrink: 0; }
    .user-info { flex: 1; }
    .sidebar.collapsed .user-info { display: none; }
    .user-name { font-size: 13px; font-weight: 600; color: #f0f4f8; }
    .user-org { font-size: 12px; color: #8899a6; }
    .topbar { height: 64px; background: #111d2e; border-bottom: 1px solid #1e2d3d; padding: 0 32px; display: flex; align-items: center; justify-content: space-between; gap: 24px; }
    .topbar-left { display: flex; align-items: center; gap: 32px; flex: 1; }
    .page-title { font-size: 24px; font-weight: 700; color: #f0f4f8; }
    .search-box { background: #0a1628; border: 1px solid #1e2d3d; border-radius: 8px; padding: 8px 12px; width: 280px; color: #f0f4f8; font-size: 14px; transition: all 0.2s ease; }
    .search-box:focus { outline: none; border-color: #3b82f6; background: #0d1520; }
    .topbar-right { display: flex; align-items: center; gap: 16px; }
    .icon-btn { width: 40px; height: 40px; border: 1px solid #1e2d3d; background: rgba(59, 130, 246, 0.1); border-radius: 6px; color: #3b82f6; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: all 0.2s ease; }
    .icon-btn:hover { background: rgba(59, 130, 246, 0.2); border-color: #3b82f6; }
    .icon-btn.notification { position: relative; }
    .notification-dot { position: absolute; top: 6px; right: 6px; width: 8px; height: 8px; background: #ff6b6b; border-radius: 50%; }
    .notification-dropdown { display: none; position: absolute; top: 50px; right: 0; background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; min-width: 320px; z-index: 500; }
    .notification-dropdown.active { display: block; }
    .notification-item { padding: 12px 16px; border-bottom: 1px solid #1e2d3d; font-size: 13px; color: #f0f4f8; cursor: pointer; transition: all 0.2s ease; }
    .notification-item:last-child { border-bottom: none; }
    .notification-item:hover { background: rgba(59, 130, 246, 0.1); }
    .notification-time { font-size: 11px; color: #8899a6; margin-top: 4px; }
    .btn-primary { background: #3b82f6; color: white; border: none; padding: 10px 16px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
    .btn-primary:hover { background: #2563eb; }
    .btn-secondary { background: rgba(59, 130, 246, 0.1); color: #3b82f6; border: 1px solid #1e2d3d; padding: 10px 16px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
    .btn-secondary:hover { background: rgba(59, 130, 246, 0.2); }
    .btn-gold { background: #d4a843; color: #0a1628; border: none; padding: 10px 16px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
    .btn-gold:hover { background: #e5b960; }
    .main-container { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .content { flex: 1; overflow-y: auto; padding: 32px; background: linear-gradient(135deg, #0a1628 0%, #0d1520 100%); }
    .content::-webkit-scrollbar { width: 8px; }
    .content::-webkit-scrollbar-track { background: transparent; }
    .content::-webkit-scrollbar-thumb { background: #1e2d3d; border-radius: 4px; }
    .content::-webkit-scrollbar-thumb:hover { background: #2a3a4d; }
    .page { display: none; opacity: 0; transition: opacity 0.3s ease; }
    .page.active { display: block; opacity: 1; }
    .card { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 24px; transition: all 0.2s ease; }
    .card:hover { border-color: #2a3a4d; }
    .metrics-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 32px; }
    .metric-card { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 20px; text-align: center; }
    .metric-value { font-size: 32px; font-weight: 700; color: #3b82f6; margin: 8px 0; }
    .metric-label { font-size: 13px; color: #8899a6; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; }
    .section { margin-bottom: 32px; }
    .section-title { font-size: 18px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px; }
    .badge { display: inline-block; padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px; }
    .badge-success { background: rgba(78, 205, 196, 0.2); color: #4ecdc4; }
    .badge-primary { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
    .badge-warning { background: rgba(212, 168, 67, 0.2); color: #d4a843; }
    .badge-danger { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }
    .verified-badge { background: rgba(78, 205, 196, 0.2); color: #4ecdc4; padding: 6px 12px; border-radius: 4px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; }
    .activity-item { padding: 16px; border-bottom: 1px solid #1e2d3d; display: flex; gap: 12px; align-items: flex-start; }
    .activity-item:last-child { border-bottom: none; }
    .activity-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; margin-top: 6px; }
    .activity-dot.completed { background: #4ecdc4; }
    .activity-dot.generated { background: #3b82f6; }
    .activity-dot.new { background: #d4a843; }
    .activity-dot.cheat { background: #ff6b6b; }
    .activity-content { flex: 1; min-width: 0; }
    .activity-text { font-size: 14px; color: #f0f4f8; margin-bottom: 2px; }
    .activity-time { font-size: 12px; color: #8899a6; }
    .challenge-card { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 24px; margin-bottom: 24px; }
    .challenge-title { font-size: 18px; font-weight: 600; color: #f0f4f8; margin-bottom: 8px; }
    .challenge-meta { display: flex; gap: 16px; font-size: 13px; color: #8899a6; margin-bottom: 16px; }
    .challenge-section { margin-bottom: 20px; }
    .challenge-section-title { font-size: 13px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 8px; }
    .challenge-brief { font-size: 14px; color: #f0f4f8; line-height: 1.6; }
    .criteria-list { font-size: 14px; color: #f0f4f8; line-height: 1.7; list-style: disc; margin-left: 20px; }
    .pivot-spec { background: rgba(255, 107, 107, 0.1); border: 1px solid #ff6b6b; border-radius: 6px; padding: 12px 16px; margin: 12px 0; color: #f0f4f8; font-size: 14px; line-height: 1.6; }
    .pivot-label { color: #ff6b6b; font-weight: 600; font-size: 12px; text-transform: uppercase; margin-bottom: 4px; }
    .stack-tags { display: flex; gap: 8px; flex-wrap: wrap; }
    .stack-tag { background: rgba(59, 130, 246, 0.15); color: #3b82f6; padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: 600; }
    .challenge-stats { display: flex; gap: 32px; padding-top: 16px; border-top: 1px solid #1e2d3d; }
    .stat { display: flex; gap: 8px; }
    .stat-label { color: #8899a6; font-size: 12px; font-weight: 500; }
    .stat-value { color: #f0f4f8; font-weight: 600; font-size: 14px; }
    .action-bar { display: flex; gap: 12px; margin-top: 16px; }
    .action-bar button { flex: 1; }
    .candidates-table { width: 100%; border-collapse: collapse; }
    .candidates-table th { background: #152238; padding: 12px 16px; text-align: left; font-size: 12px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; border-bottom: 1px solid #1e2d3d; }
    .candidates-table td { padding: 16px; border-bottom: 1px solid #1e2d3d; font-size: 14px; color: #f0f4f8; }
    .candidates-table tr:hover { background: rgba(59, 130, 246, 0.05); }
    .candidate-name { display: flex; align-items: center; gap: 12px; }
    .candidate-avatar { width: 32px; height: 32px; border-radius: 6px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 12px; }
    .candidate-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
    .candidate-id { font-size: 12px; color: #8899a6; }
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); z-index: 1000; align-items: center; justify-content: center; }
    .modal-overlay.active { display: flex; }
    .modal { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 12px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; padding: 32px; }
    .modal.wide { max-width: 1200px; }
    .modal-header { font-size: 20px; font-weight: 700; color: #f0f4f8; margin-bottom: 24px; display: flex; justify-content: space-between; align-items: center; }
    .modal-close { background: none; border: none; color: #8899a6; font-size: 24px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; }
    .modal-close:hover { color: #f0f4f8; }
    .form-group { margin-bottom: 20px; }
    .form-label { display: block; font-size: 13px; font-weight: 600; color: #f0f4f8; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.3px; }
    .form-input, .form-textarea, .form-select { width: 100%; background: #0a1628; border: 1px solid #1e2d3d; border-radius: 6px; padding: 10px 12px; color: #f0f4f8; font-size: 14px; font-family: 'Inter', sans-serif; transition: all 0.2s ease; }
    .form-input:focus, .form-textarea:focus, .form-select:focus { outline: none; border-color: #3b82f6; background: #0d1520; }
    .form-textarea { resize: vertical; min-height: 80px; }
    .checkbox-group { display: flex; align-items: center; gap: 12px; cursor: pointer; }
    .checkbox-input { width: 18px; height: 18px; cursor: pointer; }
    .slider-container { display: flex; align-items: center; gap: 12px; }
    .slider { flex: 1; }
    .slider-value { min-width: 40px; text-align: right; font-weight: 600; color: #3b82f6; }
    .tabs { display: flex; gap: 16px; border-bottom: 1px solid #1e2d3d; margin-bottom: 24px; }
    .tab { padding: 12px 0; border-bottom: 2px solid transparent; color: #8899a6; cursor: pointer; font-weight: 500; transition: all 0.2s ease; }
    .tab:hover { color: #f0f4f8; }
    .tab.active { color: #3b82f6; border-bottom-color: #3b82f6; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; }
    .rubric-dimension { margin-bottom: 24px; }
    .dimension-label { font-size: 13px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 12px; }
    .dimension-scale { display: flex; gap: 12px; font-size: 12px; color: #8899a6; margin-top: 8px; }
    .progress-bar { width: 100%; height: 6px; background: #0a1628; border-radius: 3px; overflow: hidden; margin-bottom: 8px; }
    .progress-fill { height: 100%; background: #3b82f6; border-radius: 3px; transition: width 0.3s ease; }
    .progress-label { display: flex; justify-content: space-between; font-size: 12px; color: #8899a6; margin-bottom: 8px; }
    .toast { position: fixed; top: 16px; right: 16px; background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 16px 20px; font-size: 14px; z-index: 2000; animation: slideIn 0.3s ease; }
    .toast.success { border-color: #4ecdc4; color: #4ecdc4; }
    .toast.error { border-color: #ff6b6b; color: #ff6b6b; }
    .toast.info { border-color: #3b82f6; color: #3b82f6; }
    .toast.warning { border-color: #d4a843; color: #d4a843; }
    @keyframes slideIn { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    @keyframes shimmer { 0% { background-position: -1000px 0; } 100% { background-position: 1000px 0; } }
    .skeleton { background: linear-gradient(90deg, #152238 25%, #1e2d3d 50%, #152238 75%); background-size: 1000px 100%; animation: shimmer 2s infinite; border-radius: 6px; }
    .skeleton-text { height: 16px; margin-bottom: 8px; }
    .skeleton-line { height: 12px; margin-bottom: 6px; }
    .commitment-flow { display: flex; align-items: center; gap: 8px; }
    .commitment-step { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; }
    .commitment-step.complete { background: #4ecdc4; color: #0a1628; }
    .commitment-step.pending { background: #1e2d3d; color: #8899a6; }
    .pivot-timeline { display: flex; align-items: center; gap: 16px; margin: 20px 0; }
    .pivot-line { flex: 1; height: 2px; background: #1e2d3d; }
    .pivot-marker { width: 12px; height: 12px; border-radius: 50%; background: #ff6b6b; }
    .commit-feed { max-height: 400px; overflow-y: auto; border: 1px solid #1e2d3d; border-radius: 8px; padding: 0; }
    .commit-item { padding: 16px; border-bottom: 1px solid #1e2d3d; display: flex; gap: 12px; }
    .commit-item:last-child { border-bottom: none; }
    .commit-item.pivot-marker { background: rgba(255, 107, 107, 0.1); }
    .commit-marker { width: 8px; height: 8px; border-radius: 50%; background: #3b82f6; flex-shrink: 0; margin-top: 6px; }
    .commit-item.pivot-marker .commit-marker { background: #ff6b6b; }
    .commit-content { flex: 1; }
    .pivot-label { color: #ff6b6b; font-weight: 700; font-size: 12px; text-transform: uppercase; margin-bottom: 4px; }
    .commit-time { font-size: 12px; color: #8899a6; }
    .commit-msg { font-size: 14px; color: #f0f4f8; margin: 4px 0; font-weight: 500; }
    .commit-stats { font-size: 12px; color: #8899a6; margin-top: 4px; }
    .session-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
    .stat-box { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 16px; }
    .stat-box-label { font-size: 12px; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 8px; }
    .stat-box-value { font-size: 24px; font-weight: 700; color: #f0f4f8; }
    .anti-cheat-panel { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 16px; margin-bottom: 24px; }
    .anti-cheat-title { font-size: 13px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 12px; }
    .anti-cheat-items { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .anti-cheat-item { padding: 12px; background: #0a1628; border: 1px solid #1e2d3d; border-radius: 6px; display: flex; align-items: center; gap: 8px; }
    .anti-cheat-item.verified { border-color: #4ecdc4; background: rgba(78, 205, 196, 0.1); }
    .anti-cheat-item.pending { border-color: #d4a843; background: rgba(212, 168, 67, 0.1); }
    .anti-cheat-dot { width: 8px; height: 8px; border-radius: 50%; }
    .anti-cheat-item.verified .anti-cheat-dot { background: #4ecdc4; }
    .anti-cheat-item.pending .anti-cheat-dot { background: #d4a843; }
    .anti-cheat-text { font-size: 12px; }
    .fitfolio-header { text-align: center; margin-bottom: 24px; }
    .fitfolio-avatar { width: 64px; height: 64px; border-radius: 8px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 24px; margin: 0 auto 16px; }
    .fitfolio-name { font-size: 18px; font-weight: 700; color: #f0f4f8; margin-bottom: 8px; }
    .fitfolio-headline { font-size: 14px; color: #8899a6; }
    .skill-radar { background: #0a1628; border-radius: 8px; padding: 20px; margin-bottom: 20px; }
    .skill-bar { margin-bottom: 16px; }
    .skill-label { font-size: 12px; font-weight: 600; color: #8899a6; margin-bottom: 6px; display: flex; justify-content: space-between; }
    .skill-value { color: #3b82f6; font-weight: 700; }
    .skill-bar-fill { width: 100%; height: 8px; background: #152238; border-radius: 4px; overflow: hidden; }
    .skill-bar-progress { height: 100%; background: linear-gradient(90deg, #3b82f6, #8b5cf6); border-radius: 4px; }
    .filter-bar { display: flex; gap: 16px; margin-bottom: 24px; align-items: center; }
    .filter-item { display: flex; align-items: center; gap: 8px; }
    .filter-label { font-size: 13px; font-weight: 600; color: #8899a6; text-transform: uppercase; }
    .batch-actions { display: flex; gap: 12px; margin-bottom: 16px; padding: 12px 16px; background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; }
    .batch-actions.hidden { display: none; }
    .widener-tag { background: rgba(78, 205, 196, 0.15); color: #4ecdc4; padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: 600; display: inline-block; margin-right: 4px; margin-bottom: 4px; }
    .proof-stack { font-size: 13px; font-weight: 700; color: #3b82f6; }
    .action-buttons { display: flex; gap: 8px; }
    .btn-small { background: rgba(59, 130, 246, 0.1); color: #3b82f6; border: 1px solid #1e2d3d; padding: 6px 12px; border-radius: 4px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
    .btn-small:hover { background: rgba(59, 130, 246, 0.2); }
    .compare-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .compare-card { background: #0a1628; border: 1px solid #1e2d3d; border-radius: 8px; padding: 20px; }
    .compare-card-header { border-bottom: 1px solid #1e2d3d; padding-bottom: 12px; margin-bottom: 12px; }
    .compare-row { display: flex; justify-content: space-between; font-size: 13px; margin-bottom: 12px; }
    .compare-label { color: #8899a6; }
    .compare-value { color: #f0f4f8; font-weight: 600; }
    .kpi-panel { background: #111d2e; border: 1px solid #1e2d3d; border-radius: 8px; padding: 20px; margin-bottom: 24px; }
    .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
    .kpi-item { text-align: center; }
    .kpi-value { font-size: 24px; font-weight: 700; color: #3b82f6; margin-bottom: 4px; }
    .kpi-label { font-size: 12px; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; }
    .button-group { display: flex; gap: 12px; }
    .button-group button { flex: 1; }
    @media (max-width: 1200px) { .sidebar.collapsed { width: 64px; } .metrics-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 768px) { .sidebar { display: none; } .topbar { padding: 0 16px; } .content { padding: 16px; } .metrics-grid { grid-template-columns: 1fr; } .two-column { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div id="app">
    <div class="sidebar">
      <div class="sidebar-top">
        <div class="logo">‚óÜ MendelHire</div>
      </div>
      <div class="nav">
        <div class="nav-item active" data-page="dashboard"><span class="nav-icon">üìä</span><span class="nav-text">Dashboard</span></div>
        <div class="nav-item" data-page="challenges"><span class="nav-icon">‚öôÔ∏è</span><span class="nav-text">Challenges</span></div>
        <div class="nav-item" data-page="live-session"><span class="nav-icon">‚ñ∂Ô∏è</span><span class="nav-text">Live Session</span></div>
        <div class="nav-item" data-page="candidates"><span class="nav-icon">üë•</span><span class="nav-text">Candidates</span></div>
        <div class="nav-item" data-page="scoring"><span class="nav-icon">üéØ</span><span class="nav-text">Scoring</span></div>
        <div class="nav-item" data-page="settings"><span class="nav-icon">‚öôÔ∏è</span><span class="nav-text">Settings</span></div>
      </div>
      <div class="sidebar-bottom">
        <div class="user-avatar">CA</div>
        <div class="user-info">
          <div class="user-name">Charbel A.</div>
          <div class="user-org">Talent Gurus</div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <div class="topbar">
        <div class="topbar-left">
          <div class="page-title" id="pageTitle">Dashboard</div>
          <input type="text" class="search-box" id="searchBox" placeholder="Search candidates, challenges...">
        </div>
        <div class="topbar-right">
          <div class="icon-btn notification" id="notificationBtn">
            üîî
            <div class="notification-dot"></div>
          </div>
          <div class="notification-dropdown" id="notificationDropdown">
            <div class="notification-item">‚úì Sarah Chen completed proof<span class="notification-time">2 min ago</span></div>
            <div class="notification-item">üìã FitFolio generated for MH-2844<span class="notification-time">15 min ago</span></div>
            <div class="notification-item">üéØ New score submitted: 4.2<span class="notification-time">28 min ago</span></div>
            <div class="notification-item">üìß Invite sent to 3 candidates<span class="notification-time">1 hour ago</span></div>
            <div class="notification-item">üí∞ Stipend paid to MH-2841<span class="notification-time">3 hours ago</span></div>
          </div>
          <button class="btn-primary">+ Create Challenge</button>
        </div>
      </div>

      <div class="content">
        <!-- DASHBOARD PAGE -->
        <div id="dashboard" class="page active">
          <div style="margin-bottom: 24px;">
            <div style="font-size: 14px; color: #8899a6; margin-bottom: 8px;">Good morning, Charbel A.</div>
            <div style="font-size: 14px; color: #8899a6;" id="dateDisplay"></div>
          </div>

          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-label">Active Challenges</div>
              <div class="metric-value">2</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">Candidates in Pipeline</div>
              <div class="metric-value">8</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">Proofs Completed</div>
              <div class="metric-value">5</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">Avg Score</div>
              <div class="metric-value">4.0</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">Completion Rate</div>
              <div class="metric-value">62%</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">Median Review Time</div>
              <div class="metric-value">3.2h</div>
            </div>
          </div>

          <div class="kpi-panel">
            <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Weekly KPIs</div>
            <div class="kpi-grid">
              <div class="kpi-item">
                <div class="kpi-value">847</div>
                <div class="kpi-label">Visits</div>
              </div>
              <div class="kpi-item">
                <div class="kpi-value">12.3%</div>
                <div class="kpi-label">CTR</div>
              </div>
              <div class="kpi-item">
                <div class="kpi-value">8.1%</div>
                <div class="kpi-label">Conversion Rate</div>
              </div>
              <div class="kpi-item">
                <div class="kpi-value">87%</div>
                <div class="kpi-label">Proof Completion</div>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Active Challenges</div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
              <div class="card">
                <div style="font-size: 16px; font-weight: 600; color: #f0f4f8; margin-bottom: 12px;">Frontend React ‚Äî Search + Accessibility Pivot</div>
                <div style="font-size: 12px; color: #8899a6; margin-bottom: 16px;">React, TypeScript, CSS</div>
                <div style="margin-bottom: 12px;">
                  <div style="font-size: 12px; color: #8899a6; margin-bottom: 6px;">Pipeline Status</div>
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: 60%;"></div>
                  </div>
                  <div style="font-size: 12px; color: #f0f4f8;">3 Scored ‚Ä¢ 2 In Progress ‚Ä¢ 1 Invited</div>
                </div>
              </div>
              <div class="card">
                <div style="font-size: 16px; font-weight: 600; color: #f0f4f8; margin-bottom: 12px;">Data Analysis ‚Äî Retention Cohorts + Pivot</div>
                <div style="font-size: 12px; color: #8899a6; margin-bottom: 16px;">Python, SQL, Pandas</div>
                <div style="margin-bottom: 12px;">
                  <div style="font-size: 12px; color: #8899a6; margin-bottom: 6px;">Pipeline Status</div>
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: 40%;"></div>
                  </div>
                  <div style="font-size: 12px; color: #f0f4f8;">2 Scored ‚Ä¢ 1 In Progress ‚Ä¢ 0 Invited</div>
                </div>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Recent Activity</div>
            <div class="card" style="padding: 0;">
              <div class="activity-item">
                <div class="activity-dot completed"></div>
                <div class="activity-content">
                  <div class="activity-text">‚úì Sarah Chen completed proof for Frontend React</div>
                  <div class="activity-time">2 minutes ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot generated"></div>
                <div class="activity-content">
                  <div class="activity-text">üìã FitFolio generated for Alex Rivera (MH-2844)</div>
                  <div class="activity-time">15 minutes ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot new"></div>
                <div class="activity-content">
                  <div class="activity-text">‚úì Score submitted: Priya Patel (4.2) ‚Äî Frontend React</div>
                  <div class="activity-time">28 minutes ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot generated"></div>
                <div class="activity-content">
                  <div class="activity-text">üìã Challenge published: "Backend API ‚Äî Rate Limiter Pivot"</div>
                  <div class="activity-time">1 hour ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot new"></div>
                <div class="activity-content">
                  <div class="activity-text">üìß Invite sent to 3 candidates</div>
                  <div class="activity-time">2 hours ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot completed"></div>
                <div class="activity-content">
                  <div class="activity-text">üí∞ Stipend paid: $150 to MH-2841</div>
                  <div class="activity-time">3 hours ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot cheat"></div>
                <div class="activity-content">
                  <div class="activity-text">‚ö†Ô∏è Cheat flag raised: Unusual commit pattern detected for MH-2847</div>
                  <div class="activity-time">5 hours ago</div>
                </div>
              </div>
              <div class="activity-item">
                <div class="activity-dot completed"></div>
                <div class="activity-content">
                  <div class="activity-text">‚úì Jordan Lee started live proof session</div>
                  <div class="activity-time">6 hours ago</div>
                </div>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Quick Actions</div>
            <div style="display: flex; gap: 12px;">
              <button class="btn-primary">Review Pending Proofs</button>
              <button class="btn-secondary">Invite Candidates</button>
              <button class="btn-secondary">View Reports</button>
            </div>
          </div>
        </div>

        <!-- CHALLENGES PAGE -->
        <div id="challenges" class="page">
          <div style="margin-bottom: 24px;">
            <button class="btn-primary" id="createChallengeBtn">+ Create New Challenge</button>
          </div>

          <div class="challenge-card">
            <div class="badge badge-primary" style="margin-bottom: 12px;">Published Rubric</div>
            <div class="challenge-title">Frontend React ‚Äî Search + Accessibility Pivot</div>
            <div class="challenge-meta">
              <span>React, TypeScript, CSS</span>
              <span>120 min ‚Ä¢ $100 stipend</span>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Brief</div>
              <div class="challenge-brief">Build a product list component with client-side search and category filter. The component should handle a dataset of 50+ items with real-time filtering. At minute 60, the pivot is triggered: add full keyboard navigation and ARIA labels for all interactive controls.</div>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Acceptance Criteria</div>
              <ul class="criteria-list">
                <li>Real-time search filters products by name and description</li>
                <li>Category filter composes cleanly with search (both active simultaneously)</li>
                <li>Keyboard navigation: Tab, Shift+Tab, Enter, Arrow keys work across all controls</li>
                <li>ARIA labels on search input, category dropdown, and result list</li>
                <li>Basic unit tests for filter logic and debounce function</li>
                <li>README documents accessibility decisions and tradeoffs</li>
              </ul>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Pivot Specification</div>
              <div class="pivot-spec">
                <div class="pivot-label">‚è±Ô∏è At 60 Minutes</div>
                "Add keyboard navigation and ARIA labels for all controls. Focus on accessibility best practices. Justify your implementation choices in the README."
              </div>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Stack</div>
              <div class="stack-tags">
                <div class="stack-tag">React</div>
                <div class="stack-tag">TypeScript</div>
                <div class="stack-tag">CSS</div>
              </div>
            </div>
            <div class="challenge-stats">
              <div class="stat"><div class="stat-label">Candidates</div><div class="stat-value">6</div></div>
              <div class="stat"><div class="stat-label">Scored</div><div class="stat-value">3</div></div>
              <div class="stat"><div class="stat-label">In Progress</div><div class="stat-value">2</div></div>
              <div class="stat"><div class="stat-label">Avg Score</div><div class="stat-value">4.0</div></div>
            </div>
            <div class="action-bar">
              <button class="btn-secondary" onclick="openRubricModal('frontend')">View Full Rubric</button>
              <button class="btn-secondary" onclick="openInviteModal('frontend')">Invite Candidates</button>
              <button class="btn-secondary">View Pipeline</button>
            </div>
          </div>

          <div class="challenge-card">
            <div class="badge badge-primary" style="margin-bottom: 12px;">Published Rubric</div>
            <div class="challenge-title">Data Analysis ‚Äî Retention Cohorts + Pivot Redefinition</div>
            <div class="challenge-meta">
              <span>Python, SQL, Pandas</span>
              <span>180 min ‚Ä¢ $150 stipend</span>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Brief</div>
              <div class="challenge-brief">Analyze a CSV of user events to produce a monthly cohort retention chart and 5 key insights. At minute 60, the pivot is triggered: redefine cohorts by first paid event instead of signup date, update all analysis.</div>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Acceptance Criteria</div>
              <ul class="criteria-list">
                <li>Monthly cohort retention table and visualization</li>
                <li>5 concise, actionable insights from the data</li>
                <li>Reproducible analysis steps in notebook</li>
                <li>Pivot: cohorts redefined by first paid event with delta notes</li>
                <li>Clear documentation of methodology and assumptions</li>
                <li>At least 1 caveat about data quality or limitations</li>
              </ul>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Pivot Specification</div>
              <div class="pivot-spec">
                <div class="pivot-label">‚è±Ô∏è At 60 Minutes</div>
                "Redefine cohorts by first paid event instead of first seen. Update the retention chart. Note what changed and what stayed the same."
              </div>
            </div>
            <div class="challenge-section">
              <div class="challenge-section-title">Stack</div>
              <div class="stack-tags">
                <div class="stack-tag">Python</div>
                <div class="stack-tag">SQL</div>
                <div class="stack-tag">Pandas</div>
              </div>
            </div>
            <div class="challenge-stats">
              <div class="stat"><div class="stat-label">Candidates</div><div class="stat-value">3</div></div>
              <div class="stat"><div class="stat-label">Scored</div><div class="stat-value">2</div></div>
              <div class="stat"><div class="stat-label">In Progress</div><div class="stat-value">1</div></div>
              <div class="stat"><div class="stat-label">Avg Score</div><div class="stat-value">3.9</div></div>
            </div>
            <div class="action-bar">
              <button class="btn-secondary" onclick="openRubricModal('data')">View Full Rubric</button>
              <button class="btn-secondary" onclick="openInviteModal('data')">Invite Candidates</button>
              <button class="btn-secondary">View Pipeline</button>
            </div>
          </div>
        </div>

        <!-- LIVE SESSION PAGE -->
        <div id="live-session" class="page">
          <div class="candidate-header">
            <div class="candidate-avatar">JL</div>
            <div>
              <div style="font-size: 16px; font-weight: 600; color: #f0f4f8;">Jordan Lee (MH-2845)</div>
              <div style="font-size: 13px; color: #8899a6;">Frontend React ‚Ä¢ Live Session</div>
            </div>
            <div style="margin-left: auto; display: flex; gap: 8px;">
              <span class="badge badge-success">Live ‚óè</span>
              <span class="badge badge-primary">In Progress</span>
            </div>
          </div>

          <div class="anti-cheat-panel">
            <div class="anti-cheat-title">Anti-Cheat Verification</div>
            <div class="anti-cheat-items">
              <div class="anti-cheat-item verified">
                <div class="anti-cheat-dot"></div>
                <div class="anti-cheat-text">Identity ‚úì</div>
              </div>
              <div class="anti-cheat-item verified">
                <div class="anti-cheat-dot"></div>
                <div class="anti-cheat-text">Loom Recording ‚óè Live</div>
              </div>
              <div class="anti-cheat-item verified">
                <div class="anti-cheat-dot"></div>
                <div class="anti-cheat-text">Repo Connected ‚úì</div>
              </div>
              <div class="anti-cheat-item pending">
                <div class="anti-cheat-dot"></div>
                <div class="anti-cheat-text">Pivot Pending</div>
              </div>
              <div class="anti-cheat-item verified">
                <div class="anti-cheat-dot"></div>
                <div class="anti-cheat-text">Commit Pattern Normal</div>
              </div>
              <div class="anti-cheat-item verified">
                <div class="anti-cheat-dot"></div>
                <div class="anti-cheat-text">Code Authenticity ‚úì</div>
              </div>
            </div>
          </div>

          <div style="margin-bottom: 24px;">
            <div style="font-size: 13px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 12px;">Timeline & Pivot</div>
            <div class="pivot-timeline">
              <div style="color: #8899a6; font-size: 12px;">0m</div>
              <div class="pivot-line"></div>
              <div class="pivot-marker"></div>
              <div class="pivot-line"></div>
              <div style="color: #d4a843; font-size: 12px; font-weight: 600;">60m PIVOT</div>
              <div class="pivot-line"></div>
              <div style="color: #8899a6; font-size: 12px;">120m</div>
            </div>
          </div>

          <div class="session-stats">
            <div class="stat-box">
              <div class="stat-box-label">Commits</div>
              <div class="stat-box-value" id="liveCommitCount">0</div>
            </div>
            <div class="stat-box">
              <div class="stat-box-label">Lines Changed</div>
              <div class="stat-box-value" id="liveLineCount">0</div>
            </div>
            <div class="stat-box">
              <div class="stat-box-label">Test Coverage</div>
              <div style="margin-top: 8px;">
                <div class="progress-bar" style="margin-bottom: 6px;">
                  <div class="progress-fill" id="liveTestCoverage" style="width: 0%;"></div>
                </div>
                <div style="font-size: 12px; color: #8899a6;" id="liveTestCoverageText">0%</div>
              </div>
            </div>
            <div class="stat-box">
              <div class="stat-box-label">Time Remaining</div>
              <div class="stat-box-value" id="liveTimeRemaining">120m</div>
            </div>
            <div class="stat-box">
              <div class="stat-box-label">Phase</div>
              <div class="stat-box-value" id="livePhase" style="font-size: 16px;">Pre-Pivot</div>
            </div>
            <div class="stat-box">
              <div class="stat-box-label">Files Touched</div>
              <div class="stat-box-value" id="liveFileCount">0</div>
            </div>
          </div>

          <div style="margin-bottom: 24px;">
            <div style="font-size: 13px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 12px;">Commit Feed</div>
            <div id="commitFeed" class="commit-feed"></div>
          </div>

          <div style="display: flex; gap: 12px;">
            <button class="btn-primary" id="startSimBtn" onclick="startSimulation()">Start Simulation</button>
            <button class="btn-secondary" id="pauseSimBtn" onclick="pauseSimulation()" style="display: none;">Pause</button>
            <button class="btn-secondary" onclick="resetSimulation()">Reset</button>
          </div>
        </div>

        <!-- CANDIDATES PAGE -->
        <div id="candidates" class="page">
          <div class="filter-bar">
            <div class="filter-item">
              <label class="filter-label">Search</label>
              <input type="text" class="form-input" id="candSearchInput" placeholder="Name, ID..." style="width: 200px;">
            </div>
            <div class="filter-item">
              <label class="filter-label">Status</label>
              <select class="form-select" id="statusFilter" style="width: 150px;">
                <option value="">All</option>
                <option value="In Progress">In Progress</option>
                <option value="Scored">Scored</option>
                <option value="FitFolio Ready">FitFolio Ready</option>
                <option value="Invited">Invited</option>
              </select>
            </div>
            <div class="filter-item">
              <label class="filter-label">Challenge</label>
              <select class="form-select" id="challengeFilter" style="width: 150px;">
                <option value="">All Challenges</option>
                <option value="Frontend React">Frontend React</option>
                <option value="Data Python/SQL">Data Python/SQL</option>
              </select>
            </div>
            <div class="filter-item">
              <label class="filter-label">Sort</label>
              <select class="form-select" id="sortFilter" style="width: 150px;">
                <option value="recent">Most Recent</option>
                <option value="score">Highest Score</option>
                <option value="name">Name (A-Z)</option>
              </select>
            </div>
            <div class="filter-item" style="margin-left: auto;">
              <label class="checkbox-group">
                <input type="checkbox" class="checkbox-input" id="anonModeToggle" checked>
                <span style="font-size: 13px; color: #f0f4f8;">Anonymized Mode</span>
              </label>
            </div>
          </div>

          <div class="batch-actions hidden" id="batchActions">
            <button class="btn-secondary" id="compareBtn">Compare Selected (0)</button>
          </div>

          <table class="candidates-table">
            <thead>
              <tr>
                <th style="width: 40px;"><input type="checkbox" id="selectAllCheckbox"></th>
                <th>Candidate</th>
                <th>Challenge</th>
                <th>Status</th>
                <th>Score</th>
                <th>Wideners</th>
                <th>Stack</th>
                <th>Verified</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="candidatesTableBody">
            </tbody>
          </table>
        </div>

        <!-- SCORING PAGE -->
        <div id="scoring" class="page">
          <div style="margin-bottom: 24px;">
            <label class="form-label">Select Candidate</label>
            <select class="form-select" id="scoringCandidateSelect" style="max-width: 300px;"></select>
          </div>

          <div class="candidate-header" id="scoringCandidateHeader" style="display: none; margin-bottom: 24px;">
            <div class="candidate-avatar" id="scoringAvatar"></div>
            <div>
              <div style="font-size: 16px; font-weight: 600; color: #f0f4f8;" id="scoringCandidateName"></div>
              <div style="font-size: 13px; color: #8899a6;" id="scoringChallengeInfo"></div>
            </div>
          </div>

          <div class="two-column" id="scoringContent" style="display: none;">
            <div>
              <div style="margin-bottom: 32px;">
                <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Stack Dimensions</div>
                <div class="rubric-dimension">
                  <label class="dimension-label">Correctness & Edge Cases</label>
                  <input type="range" class="slider" id="scoreCorrectness" min="1" max="5" value="3" oninput="updateScorings()">
                  <div class="dimension-scale">
                    <span>1 ‚Ä¢ Incomplete</span>
                    <span id="correctnessValue" style="color: #3b82f6; font-weight: 600;">3</span>
                    <span>5 ‚Ä¢ Exceptional</span>
                  </div>
                </div>
                <div class="rubric-dimension">
                  <label class="dimension-label">Accessibility/Data Quality</label>
                  <input type="range" class="slider" id="scoreAccessibility" min="1" max="5" value="3" oninput="updateScorings()">
                  <div class="dimension-scale">
                    <span>1 ‚Ä¢ Poor</span>
                    <span id="accessibilityValue" style="color: #3b82f6; font-weight: 600;">3</span>
                    <span>5 ‚Ä¢ Exemplary</span>
                  </div>
                </div>
                <div class="rubric-dimension">
                  <label class="dimension-label">Code Clarity</label>
                  <input type="range" class="slider" id="scoreClarity" min="1" max="5" value="3" oninput="updateScorings()">
                  <div class="dimension-scale">
                    <span>1 ‚Ä¢ Unclear</span>
                    <span id="clarityValue" style="color: #3b82f6; font-weight: 600;">3</span>
                    <span>5 ‚Ä¢ Crystal Clear</span>
                  </div>
                </div>
              </div>

              <div>
                <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Trait Dimensions</div>
                <div class="rubric-dimension">
                  <label class="dimension-label">Ownership</label>
                  <input type="range" class="slider" id="scoreOwnership" min="1" max="5" value="3" oninput="updateScorings()">
                  <div class="dimension-scale">
                    <span>1 ‚Ä¢ Minimal</span>
                    <span id="ownershipValue" style="color: #3b82f6; font-weight: 600;">3</span>
                    <span>5 ‚Ä¢ Full Ownership</span>
                  </div>
                </div>
                <div class="rubric-dimension">
                  <label class="dimension-label">Problem-Solving</label>
                  <input type="range" class="slider" id="solvingScore" min="1" max="5" value="3" oninput="updateScorings()">
                  <div class="dimension-scale">
                    <span>1 ‚Ä¢ Stuck</span>
                    <span id="solvingValue" style="color: #3b82f6; font-weight: 600;">3</span>
                    <span>5 ‚Ä¢ Creative</span>
                  </div>
                </div>
                <div class="rubric-dimension">
                  <label class="dimension-label">Communication</label>
                  <input type="range" class="slider" id="scoreComm" min="1" max="5" value="3" oninput="updateScorings()">
                  <div class="dimension-scale">
                    <span>1 ‚Ä¢ Unclear</span>
                    <span id="commValue" style="color: #3b82f6; font-weight: 600;">3</span>
                    <span>5 ‚Ä¢ Articulate</span>
                  </div>
                </div>
              </div>

              <div id="widenerScoresDiv" style="display: none;">
                <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px; margin-top: 32px;">Widener Scores</div>
                <div id="widenerScoresContainer"></div>
              </div>

              <div style="margin-top: 32px;">
                <label class="form-label">Curator Note</label>
                <textarea class="form-textarea" id="curatorNote" placeholder="Add observations, context, or concerns..."></textarea>
              </div>

              <div style="margin-top: 16px; display: flex; gap: 8px; align-items: center;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" id="curatorAdjust">
                  <span style="font-size: 13px; color: #f0f4f8;">Adjust ¬±1</span>
                </label>
              </div>
            </div>

            <div>
              <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">AI Pre-Score Comparison</div>
              <div style="background: #0a1628; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                <div style="font-size: 12px; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 16px;">Stack Dimensions vs AI</div>
                <div style="margin-bottom: 16px;">
                  <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 6px; color: #8899a6;">
                    <span>Correctness</span>
                    <span><span id="aiCorrectness">3.2</span> (AI)</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="aiCorrectnessBar" style="width: 64%;"></div>
                  </div>
                </div>
                <div style="margin-bottom: 16px;">
                  <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 6px; color: #8899a6;">
                    <span>Accessibility</span>
                    <span><span id="aiAccessibility">2.8</span> (AI)</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="aiAccessibilityBar" style="width: 56%;"></div>
                  </div>
                </div>
                <div style="margin-bottom: 16px;">
                  <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 6px; color: #8899a6;">
                    <span>Clarity</span>
                    <span><span id="aiClarity">3.5</span> (AI)</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="aiClarityBar" style="width: 70%;"></div>
                  </div>
                </div>
              </div>

              <div style="background: #0a1628; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                <div style="font-size: 12px; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 12px;">Overall Score</div>
                <div style="font-size: 48px; font-weight: 700; color: #3b82f6;" id="overallScore">3.0</div>
                <div style="font-size: 12px; color: #8899a6; margin-top: 8px;">Based on 6 dimensions</div>
              </div>

              <div style="display: flex; gap: 12px;">
                <button class="btn-secondary" onclick="saveScoringDraft()">Save Draft</button>
                <button class="btn-gold" onclick="generateFitfolio()">Generate FitFolio ‚Üí</button>
              </div>
            </div>
          </div>
        </div>

        <!-- SETTINGS PAGE -->
        <div id="settings" class="page">
          <div class="section">
            <div class="section-title">Team Members</div>
            <div class="card" style="padding: 0;">
              <div style="padding: 20px; border-bottom: 1px solid #1e2d3d; display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">Charbel A.</div>
                  <div style="font-size: 12px; color: #8899a6;">Admin ‚Ä¢ Talent Gurus</div>
                </div>
                <span class="badge badge-primary">Admin</span>
              </div>
              <div style="padding: 20px; border-bottom: 1px solid #1e2d3d; display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">Maya</div>
                  <div style="font-size: 12px; color: #8899a6;">Senior Reviewer</div>
                </div>
                <span class="badge badge-success">Reviewer</span>
              </div>
              <div style="padding: 20px; display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">David</div>
                  <div style="font-size: 12px; color: #8899a6;">Technical Reviewer</div>
                </div>
                <span class="badge badge-success">Reviewer</span>
              </div>
            </div>
            <button class="btn-secondary" style="margin-top: 16px;" onclick="showInviteMemberModal()">Invite Team Member</button>
          </div>

          <div class="section">
            <div class="section-title">Integrations</div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
              <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                  <div>
                    <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">GitHub OAuth</div>
                    <div style="font-size: 12px; color: #8899a6; margin-top: 4px;">Connect for repo analysis</div>
                  </div>
                  <span class="badge badge-success">Connected</span>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 8px;">
                  <button class="btn-small">Disconnect</button>
                </div>
              </div>
              <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                  <div>
                    <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">Stripe Payouts</div>
                    <div style="font-size: 12px; color: #8899a6; margin-top: 4px;">Stipend automation</div>
                  </div>
                  <span class="badge badge-success">Connected</span>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 8px;">
                  <button class="btn-small">Manage</button>
                </div>
              </div>
              <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                  <div>
                    <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">Slack Notifications</div>
                    <div style="font-size: 12px; color: #8899a6; margin-top: 4px;">Get alerts in Slack</div>
                  </div>
                  <span class="badge badge-warning">Not Connected</span>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 8px;">
                  <button class="btn-primary" style="flex: 1;">Connect</button>
                </div>
              </div>
              <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                  <div>
                    <div style="font-size: 14px; font-weight: 600; color: #f0f4f8;">Greenhouse ATS</div>
                    <div style="font-size: 12px; color: #8899a6; margin-top: 4px;">Sync candidates</div>
                  </div>
                  <span class="badge badge-warning">Not Connected</span>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 8px;">
                  <button class="btn-primary" style="flex: 1;">Connect</button>
                </div>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Anti-Cheat Settings</div>
            <div class="card">
              <div style="margin-bottom: 20px;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8; flex: 1;">Identity Check (required)</span>
                </label>
              </div>
              <div style="margin-bottom: 20px;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8; flex: 1;">Repo Diff Analysis</span>
                </label>
              </div>
              <div style="margin-bottom: 20px;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8; flex: 1;">Mid-Task Pivot Verification</span>
                </label>
              </div>
              <div style="margin-bottom: 20px;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8; flex: 1;">Loom Recording Required</span>
                </label>
              </div>
              <div style="margin-bottom: 16px;">
                <label class="form-label">Cheat Flag Threshold</label>
                <div style="display: flex; align-items: center; gap: 12px;">
                  <input type="range" class="slider" min="0" max="100" value="75" style="flex: 1;">
                  <span style="color: #3b82f6; font-weight: 600; min-width: 40px;">75%</span>
                </div>
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Stipend Settings</div>
            <div class="card">
              <div class="form-group">
                <label class="form-label">120 Minute Challenge</label>
                <input type="text" class="form-input" value="$100" readonly>
              </div>
              <div class="form-group">
                <label class="form-label">180 Minute Challenge</label>
                <input type="text" class="form-input" value="$150" readonly>
              </div>
              <div style="padding: 12px; background: rgba(78, 205, 196, 0.1); border-radius: 6px; font-size: 12px; color: #8899a6;">
                Payment method: Stripe connected ‚Ä¢ Automatic payouts enabled
              </div>
            </div>
          </div>

          <div class="section">
            <div class="section-title">Notification Preferences</div>
            <div class="card">
              <div style="margin-bottom: 16px;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8;">Email notifications (proofs, scores, invites)</span>
                </label>
              </div>
              <div style="margin-bottom: 16px;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8;">Slack alerts (urgent issues only)</span>
                </label>
              </div>
              <div style="margin-bottom: 0;">
                <label class="checkbox-group">
                  <input type="checkbox" class="checkbox-input" checked>
                  <span style="font-size: 14px; color: #f0f4f8;">Weekly digest (summary report)</span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODALS -->
  <div id="rubricModal" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div>Full Rubric</div>
        <button class="modal-close" onclick="document.getElementById('rubricModal').classList.remove('active')">√ó</button>
      </div>
      <div id="rubricContent"></div>
    </div>
  </div>

  <div id="fitfolioModal" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div id="fitfolioModalTitle">FitFolio</div>
        <button class="modal-close" onclick="document.getElementById('fitfolioModal').classList.remove('active')">√ó</button>
      </div>
      <div class="fitfolio-header">
        <div class="fitfolio-avatar" id="fitfolioAvatar"></div>
        <div class="fitfolio-name" id="fitfolioName"></div>
        <div class="verified-badge" style="display: inline-block;">‚úì VERIFIED CRAFT</div>
        <div class="fitfolio-headline" id="fitfolioHeadline"></div>
      </div>
      <div id="fitfolioTabs" class="tabs">
        <div class="tab active" onclick="switchFitfolioTab(event, 'tab-hm-card')">Hiring Manager Card</div>
        <div class="tab" onclick="switchFitfolioTab(event, 'tab-ats-llm')">ATS & LLM Factsheet</div>
        <div class="tab" onclick="switchFitfolioTab(event, 'tab-portfolio')">Portfolio Page</div>
      </div>
      <div id="tab-hm-card" class="tab-content active">
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Skill Radar</div>
          <div class="skill-radar" id="fitfolioSkillRadar"></div>
        </div>
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Proof Snapshot</div>
          <div style="background: #0a1628; border-radius: 8px; padding: 16px;" id="fitfolioProofSnapshot"></div>
        </div>
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Widener Results</div>
          <div id="fitfolioWidenerResults"></div>
        </div>
        <div style="background: rgba(212, 168, 67, 0.1); border: 1px solid #d4a843; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
          <div style="font-size: 12px; font-weight: 600; color: #d4a843; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 8px;">Curator Note</div>
          <div style="font-size: 14px; color: #f0f4f8;" id="fitfolioCuratorNote"></div>
        </div>
        <div>
          <div style="font-size: 12px; font-weight: 600; color: #8899a6; text-transform: uppercase; letter-spacing: 0.3px; margin-bottom: 8px;">Ask Me About</div>
          <div id="fitfolioAskAbout"></div>
        </div>
      </div>
      <div id="tab-ats-llm" class="tab-content">
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Five Verifiable Facts</div>
          <div id="fitfolioVerifiableFacts"></div>
        </div>
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">JSON-LD Preview</div>
          <pre style="background: #0a1628; border: 1px solid #1e2d3d; border-radius: 6px; padding: 12px; font-size: 12px; color: #8899a6; overflow-x: auto;" id="fitfolioJSONLD"></pre>
        </div>
        <div style="padding: 12px; background: rgba(78, 205, 196, 0.1); border-radius: 6px; font-size: 12px; color: #8899a6; margin-bottom: 24px;">
          Resume-safe: Yes ‚Ä¢ Ready for LinkedIn/GitHub
        </div>
        <div>
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 12px;">Synonym Map</div>
          <div id="fitfolioSynonymMap"></div>
        </div>
      </div>
      <div id="tab-portfolio" class="tab-content">
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 12px;">Portfolio</div>
          <div id="fitfolioPortfolioHeader"></div>
        </div>
        <div style="margin-bottom: 24px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Proof Stack Timeline</div>
          <div id="fitfolioProofTimeline"></div>
        </div>
        <div style="margin-bottom: 24px;">
          <label class="form-label">Share Link</label>
          <div style="display: flex; gap: 8px;">
            <input type="text" class="form-input" id="shareLink" value="mendelhire.com/portfolio/mh-2841" readonly>
            <button class="btn-secondary" onclick="copyShareLink()">Copy</button>
          </div>
        </div>
        <div style="margin-bottom: 16px;">
          <label class="checkbox-group">
            <input type="checkbox" class="checkbox-input" checked>
            <span style="font-size: 13px; color: #f0f4f8;">Public ‚Ä¢ Can be shared</span>
          </label>
        </div>
        <div>
          <button class="btn-secondary" style="width: 100%;">Download as PDF</button>
        </div>
      </div>
    </div>
  </div>

  <div id="inviteModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div>Invite Candidates</div>
        <button class="modal-close" onclick="document.getElementById('inviteModal').classList.remove('active')">√ó</button>
      </div>
      <div class="form-group">
        <label class="form-label">Challenge</label>
        <input type="text" class="form-input" id="inviteChallenge" readonly>
      </div>
      <div class="form-group">
        <label class="form-label">Email Address</label>
        <input type="email" class="form-input" id="inviteEmail" placeholder="candidate@example.com">
      </div>
      <div class="form-group">
        <label class="form-label">Message</label>
        <textarea class="form-textarea" id="inviteMessage" placeholder="Personalize your invite..."></textarea>
      </div>
      <div style="display: flex; gap: 12px; margin-top: 24px;">
        <button class="btn-primary" style="flex: 1;" onclick="sendInvite()">Send Invite</button>
        <button class="btn-secondary" onclick="document.getElementById('inviteModal').classList.remove('active')">Cancel</button>
      </div>
    </div>
  </div>

  <div id="compareModal" class="modal-overlay">
    <div class="modal wide">
      <div class="modal-header">
        <div>Side-by-Side Candidate Comparison</div>
        <button class="modal-close" onclick="document.getElementById('compareModal').classList.remove('active')">√ó</button>
      </div>
      <div class="compare-grid" id="compareGrid"></div>
    </div>
  </div>

  <div id="createChallengeModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <div id="challengeModalTitle">Create Challenge</div>
        <button class="modal-close" onclick="closeCreateChallengeModal()">√ó</button>
      </div>

      <div id="challengeStep1">
        <div class="form-group">
          <label class="form-label">Role / Function</label>
          <select class="form-select" id="roleSelect">
            <option value="">Select a role...</option>
            <option value="frontend">Frontend Engineer</option>
            <option value="backend">Backend Engineer</option>
            <option value="fullstack">Full-Stack Engineer</option>
            <option value="data">Data Analyst / Scientist</option>
            <option value="devops">DevOps / Infrastructure</option>
            <option value="ai-ml">AI/ML Engineer</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Focus (optional)</label>
          <input type="text" class="form-input" id="focusInput" placeholder="e.g., React, PostgreSQL, Kubernetes...">
        </div>
        <div class="form-group">
          <label class="form-label">Duration</label>
          <select class="form-select" id="durationSelect">
            <option value="120">120 minutes ($100 stipend)</option>
            <option value="180">180 minutes ($150 stipend)</option>
          </select>
        </div>
        <div style="display: flex; gap: 12px; margin-top: 24px;">
          <button class="btn-primary" style="flex: 1;" onclick="generateChallengeStep2()">Generate with AI ‚Üí</button>
          <button class="btn-secondary" onclick="closeCreateChallengeModal()">Cancel</button>
        </div>
      </div>

      <div id="challengeStep2" style="display: none;">
        <div style="text-align: center; padding: 32px;">
          <div style="width: 40px; height: 40px; border: 3px solid #3b82f6; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
          <div style="font-size: 14px; color: #f0f4f8;" id="aiStatusText">Analyzing role requirements</div>
        </div>
        <style>
          @keyframes spin { to { transform: rotate(360deg); } }
        </style>
      </div>

      <div id="challengeStep3" style="display: none;">
        <div class="form-group">
          <label class="form-label">Challenge Title</label>
          <input type="text" class="form-input" id="genTitle" readonly>
        </div>
        <div class="form-group">
          <label class="form-label">Tech Stack</label>
          <input type="text" class="form-input" id="genStack" readonly>
        </div>
        <div class="form-group">
          <label class="form-label">Duration & Stipend</label>
          <input type="text" class="form-input" id="genMeta" readonly>
        </div>
        <div class="form-group">
          <label class="form-label">Brief</label>
          <textarea class="form-textarea" id="genBrief" readonly></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Acceptance Criteria</label>
          <textarea class="form-textarea" id="genCriteria" readonly style="min-height: 120px;"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Pivot Specification (60 min)</label>
          <textarea class="form-textarea" id="genPivot" readonly style="min-height: 80px;"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Rubric Stack Dimensions</label>
          <div id="genRubricStack" style="background: #0a1628; border: 1px solid #1e2d3d; border-radius: 6px; padding: 12px; font-size: 14px; color: #f0f4f8; line-height: 1.6;"></div>
        </div>
        <div style="display: flex; gap: 12px; margin-top: 24px;">
          <button class="btn-primary" style="flex: 1;" onclick="publishChallenge()">Publish Challenge</button>
          <button class="btn-secondary" onclick="resetChallengeModal()">Edit</button>
        </div>
      </div>
    </div>
  </div>

  <div id="fitfolioGenerateModal" class="modal-overlay">
    <div class="modal" style="text-align: center;">
      <div style="font-size: 48px; margin-bottom: 16px;">‚úì</div>
      <div style="font-size: 18px; font-weight: 700; color: #f0f4f8; margin-bottom: 8px;">FitFolio Generated!</div>
      <div style="font-size: 14px; color: #8899a6; margin-bottom: 24px;">Candidate profile is ready for review</div>
      <button class="btn-primary" style="width: 100%;" onclick="closeFitfolioGenerateModal()">View FitFolio ‚Üí</button>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

  <script>
    // ===== APP STATE =====
    const appState = {
      anonMode: true,
      currentPage: 'dashboard',
      selectedCandidates: new Set(),
      proofTime: 0,
      isProfRunning: false,
      simulationInterval: null,
      scoreChanges: {},
      candidateScores: {
        'MH-2841': { correctness: 4, accessibility: 4, clarity: 4, ownership: 4, solving: 4, comm: 4 },
        'MH-2842': { correctness: 4, accessibility: 3, clarity: 4, ownership: 3, solving: 4, comm: 3 },
        'MH-2844': { correctness: 5, accessibility: 4, clarity: 5, ownership: 5, solving: 5, comm: 4 },
        'MH-2846': { correctness: 3, accessibility: 3, clarity: 4, ownership: 3, solving: 3, comm: 3 },
        'MH-2848': { correctness: 4, accessibility: 4, clarity: 4, ownership: 4, solving: 4, comm: 3 }
      }
    };

    const candidates = [
      { id: 'MH-2841', name: 'Sarah Chen', challenge: 'Frontend React', status: 'FitFolio Ready', score: 4.2, wideners: ['Product Sense', 'Communication'], stack: 3, verified: true, avatar: 'SC', pivotTime: 5, commits: 18, lines: 1094 },
      { id: 'MH-2842', name: 'Marcus Johnson', challenge: 'Frontend React', status: 'Scored', score: 3.8, wideners: ['Collaboration', 'Diagnostics'], stack: 1, verified: true, avatar: 'MJ', pivotTime: 8, commits: 14, lines: 876 },
      { id: 'MH-2843', name: 'Priya Patel', challenge: 'Frontend React', status: 'In Progress', score: null, wideners: ['Customer Empathy', 'Communication'], stack: 2, verified: false, avatar: 'PP', pivotTime: null, commits: 0, lines: 0 },
      { id: 'MH-2844', name: 'Alex Rivera', challenge: 'Data Python/SQL', status: 'FitFolio Ready', score: 4.5, wideners: ['Product Sense', 'Diagnostics'], stack: 2, verified: true, avatar: 'AR', pivotTime: 4, commits: 16, lines: 942 },
      { id: 'MH-2845', name: 'Jordan Lee', challenge: 'Frontend React', status: 'In Progress (Live)', score: null, wideners: ['Communication', 'Collaboration'], stack: 1, verified: false, avatar: 'JL', pivotTime: null, commits: 0, lines: 0 },
      { id: 'MH-2846', name: 'Tanya Williams', challenge: 'Data Python/SQL', status: 'Scored', score: 3.5, wideners: ['Customer Empathy', 'Product Sense'], stack: 1, verified: true, avatar: 'TW', pivotTime: 12, commits: 11, lines: 654 },
      { id: 'MH-2847', name: 'Raj Krishnamurthy', challenge: 'Frontend React', status: 'Invited', score: null, wideners: [], stack: 0, verified: false, avatar: 'RK', pivotTime: null, commits: 0, lines: 0 },
      { id: 'MH-2848', name: 'Elena Volkova', challenge: 'Data Python/SQL', status: 'FitFolio Ready', score: 4.0, wideners: ['Diagnostics', 'Collaboration'], stack: 3, verified: true, avatar: 'EV', pivotTime: 6, commits: 15, lines: 812 }
    ];

    const commits = [
      { time: 3, msg: 'Init project with vite', lines: 45, files: 3 },
      { time: 7, msg: 'Add product list component', lines: 120, files: 2 },
      { time: 12, msg: 'Implement search functionality', lines: 89, files: 2 },
      { time: 18, msg: 'Add category filter', lines: 76, files: 1 },
      { time: 25, msg: 'Style product cards', lines: 143, files: 2 },
      { time: 32, msg: 'Add debounce to search', lines: 34, files: 1 },
      { time: 38, msg: 'Write unit tests', lines: 156, files: 1 },
      { time: 45, msg: 'Refactor filter logic', lines: 45, files: 1 },
      { time: 52, msg: 'Add loading states', lines: 67, files: 2 },
      { time: 58, msg: 'Final UI polish', lines: 32, files: 1 },
      { time: 60, msg: 'Pivot: Add ARIA labels', lines: 0, files: 0, isPivot: true },
      { time: 67, msg: 'Implement keyboard navigation', lines: 98, files: 2 },
      { time: 75, msg: 'Add focus management', lines: 54, files: 1 },
      { time: 82, msg: 'Write accessibility tests', lines: 178, files: 1 },
      { time: 89, msg: 'Update README with a11y docs', lines: 56, files: 1 },
      { time: 97, msg: 'Fix tabindex order', lines: 22, files: 1 },
      { time: 104, msg: 'Add skip links', lines: 34, files: 1 },
      { time: 112, msg: 'Final accessibility audit', lines: 19, files: 1 },
      { time: 118, msg: 'Commit: all tests passing', lines: 5, files: 1 }
    ];

    // ===== UTILITY FUNCTIONS =====
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.getElementById('toastContainer').appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function formatDate() {
      const now = new Date();
      const opts = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      return now.toLocaleDateString('en-US', opts);
    }

    // ===== PAGE NAVIGATION =====
    function navigateToPage(page) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(page).classList.add('active');
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      document.querySelector(`[data-page="${page}"]`).classList.add('active');
      appState.currentPage = page;
      document.getElementById('pageTitle').textContent = page.charAt(0).toUpperCase() + page.slice(1).replace('-', ' ');
      if (page === 'candidates') renderCandidatesTable();
      if (page === 'scoring') populateScoringDropdown();
    }

    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', () => {
        const page = item.getAttribute('data-page');
        window.location.hash = page;
        navigateToPage(page);
      });
    });

    window.addEventListener('hashchange', () => {
      const page = location.hash.slice(1) || 'dashboard';
      navigateToPage(page);
    });

    // ===== INITIALIZATION =====
    document.getElementById('dateDisplay').textContent = formatDate();

    document.getElementById('createChallengeBtn').addEventListener('click', () => {
      document.getElementById('createChallengeModal').classList.add('active');
      resetChallengeModal();
    });

    document.querySelector('.btn-primary').addEventListener('click', () => {
      document.getElementById('createChallengeModal').classList.add('active');
      resetChallengeModal();
    });

    document.getElementById('notificationBtn').addEventListener('click', () => {
      const dropdown = document.getElementById('notificationDropdown');
      dropdown.classList.toggle('active');
    });

    document.addEventListener('click', (e) => {
      const dropdown = document.getElementById('notificationDropdown');
      if (!e.target.closest('#notificationBtn') && !e.target.closest('#notificationDropdown')) {
        dropdown.classList.remove('active');
      }
    });

    // ===== ANONYMIZED MODE =====
    document.getElementById('anonModeToggle').addEventListener('change', (e) => {
      appState.anonMode = e.target.checked;
      renderCandidatesTable();
    });

    // ===== CANDIDATES TABLE =====
    function renderCandidatesTable() {
      const tbody = document.getElementById('candidatesTableBody');
      tbody.innerHTML = '';
      candidates.forEach(c => {
        const displayName = appState.anonMode ? c.id : c.name;
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><input type="checkbox" class="candidate-checkbox" data-id="${c.id}"></td>
          <td><div class="candidate-name"><div class="candidate-avatar">${c.avatar}</div><div><div>${displayName}</div><div class="candidate-id">${c.id}</div></div></div></td>
          <td>${c.challenge}</td>
          <td><span class="badge badge-primary">${c.status}</span></td>
          <td>${c.score ? c.score.toFixed(1) : '-'}</td>
          <td>${c.wideners.map(w => `<div class="widener-tag">${w}</div>`).join('')}</td>
          <td><span class="proof-stack">${c.stack}</span></td>
          <td>${c.verified ? '<span class="badge badge-success">‚úì</span>' : '-'}</td>
          <td>
            <div class="action-buttons">
              <button class="btn-small" onclick="openFitfolio('${c.id}', '${c.name}', '${c.avatar}', '${c.challenge}', ${c.score})">View</button>
              ${c.score ? `<button class="btn-small" onclick="goToScoring('${c.id}')">Score</button>` : ''}
              <button class="btn-small" onclick="addToComparison('${c.id}')">Compare</button>
            </div>
          </td>
        `;
        tbody.appendChild(row);
      });

      // Add checkbox listeners
      document.querySelectorAll('.candidate-checkbox').forEach(cb => {
        cb.addEventListener('change', () => {
          if (cb.checked) {
            appState.selectedCandidates.add(cb.dataset.id);
          } else {
            appState.selectedCandidates.delete(cb.dataset.id);
          }
          updateBatchActions();
        });
      });

      document.getElementById('selectAllCheckbox').addEventListener('change', (e) => {
        document.querySelectorAll('.candidate-checkbox').forEach(cb => {
          cb.checked = e.target.checked;
          if (e.target.checked) {
            appState.selectedCandidates.add(cb.dataset.id);
          } else {
            appState.selectedCandidates.delete(cb.dataset.id);
          }
        });
        updateBatchActions();
      });
    }

    function updateBatchActions() {
      const batchActions = document.getElementById('batchActions');
      const compareBtn = document.getElementById('compareBtn');
      if (appState.selectedCandidates.size > 0) {
        batchActions.classList.remove('hidden');
        compareBtn.textContent = `Compare Selected (${appState.selectedCandidates.size})`;
      } else {
        batchActions.classList.add('hidden');
      }
    }

    document.getElementById('compareBtn').addEventListener('click', () => {
      const selected = Array.from(appState.selectedCandidates);
      if (selected.length >= 2 && selected.length <= 3) {
        showComparisonModal(selected);
      } else {
        showToast('Select 2-3 candidates to compare', 'warning');
      }
    });

    // ===== FITFOLIO MODAL =====
    function openFitfolio(id, name, avatar, challenge, score) {
      const displayName = appState.anonMode ? id : name;
      document.getElementById('fitfolioModalTitle').textContent = 'FitFolio ‚Äî ' + displayName;
      document.getElementById('fitfolioAvatar').textContent = avatar;
      document.getElementById('fitfolioName').textContent = displayName;
      document.getElementById('fitfolioHeadline').textContent = 'Senior ' + (challenge.includes('Frontend') ? 'Frontend' : challenge.includes('Data') ? 'Data' : 'Software') + ' Engineer';

      // Skill Radar
      const cand = candidates.find(c => c.id === id);
      const scores = appState.candidateScores[id] || { correctness: 3, accessibility: 3, clarity: 3, ownership: 3, solving: 3, comm: 3 };
      let skillHTML = '';
      ['Correctness', 'Accessibility', 'Clarity', 'Ownership', 'Problem-Solving', 'Communication'].forEach((label, i) => {
        const dims = ['correctness', 'accessibility', 'clarity', 'ownership', 'solving', 'comm'];
        const val = scores[dims[i]] || 3;
        skillHTML += `
          <div class="skill-bar">
            <div class="skill-label">${label}<span class="skill-value">${val}/5</span></div>
            <div class="skill-bar-fill">
              <div class="skill-bar-progress" style="width: ${val * 20}%;"></div>
            </div>
          </div>
        `;
      });
      document.getElementById('fitfolioSkillRadar').innerHTML = skillHTML;

      // Proof Snapshot
      let proofHTML = `
        <div style="margin-bottom: 12px;"><strong>Challenge:</strong> ${challenge}</div>
        <div style="margin-bottom: 12px;"><strong>Duration:</strong> ${cand.stack * 40 + 40} minutes (${cand.commits} commits)</div>
        <div style="margin-bottom: 12px;"><strong>Lines Changed:</strong> ${cand.lines.toLocaleString()}</div>
        <div style="margin-bottom: 12px;"><strong>Pivot Response:</strong> ${cand.pivotTime}m into session</div>
        <div style="margin-bottom: 12px;"><strong>Repo:</strong> <a href="#" style="color: #3b82f6;">github.com/${cand.name.replace(/\s/g, '').toLowerCase()}/proof</a></div>
        <div><strong>Recording:</strong> <a href="#" style="color: #3b82f6;">loom.com/share/xyz</a></div>
      `;
      document.getElementById('fitfolioProofSnapshot').innerHTML = proofHTML;

      // Widener Results
      let widenerHTML = cand.wideners.map((w, i) => `
        <div style="margin-bottom: 12px; padding: 12px; background: rgba(78, 205, 196, 0.1); border-radius: 6px;">
          <div style="font-weight: 600; color: #f0f4f8;">${w}</div>
          <div style="font-size: 12px; color: #8899a6; margin-top: 4px;">Score: ${4 + Math.random() * 0.5}</div>
        </div>
      `).join('');
      document.getElementById('fitfolioWidenerResults').innerHTML = widenerHTML;

      // Curator Note
      document.getElementById('fitfolioCuratorNote').textContent = 'Strong ownership and exceptional communication. Navigated pivot flawlessly. Minor: could improve test coverage.';

      // Ask Me About
      document.getElementById('fitfolioAskAbout').innerHTML = ['React Patterns', 'Accessibility Best Practices', 'Problem-Solving Process'].map(t => `<div class="widener-tag">${t}</div>`).join('');

      // Verifiable Facts
      let factsHTML = [
        '1. Built and shipped 18 commits in ' + (cand.commits * 6) + ' minutes',
        '2. Achieved ' + (Math.random() * 40 + 70).toFixed(0) + '% test coverage',
        '3. Responded to mid-task pivot in under ' + (cand.pivotTime + 2) + ' minutes',
        '4. Code follows ' + (score > 4 ? 'exceptional' : 'solid') + ' accessibility standards',
        '5. Demonstrated clear communication in commit messages and README'
      ].map(f => `<div style="margin-bottom: 8px; padding: 8px; background: #0a1628; border-radius: 4px; font-size: 13px;">${f}</div>`).join('');
      document.getElementById('fitfolioVerifiableFacts').innerHTML = factsHTML;

      // JSON-LD
      document.getElementById('fitfolioJSONLD').textContent = JSON.stringify({
        "@context": "https://schema.org",
        "@type": "Person",
        "name": name,
        "jobTitle": "Senior Engineer",
        "skills": ["React", "TypeScript", "Accessibility"],
        "proofStack": cand.stack
      }, null, 2);

      // Synonym Map
      document.getElementById('fitfolioSynonymMap').innerHTML = `
        <div style="font-size: 12px; color: #8899a6; line-height: 1.8;">
          <div>‚Ä¢ "Search functionality" ‚Üí React hooks, debouncing, state management</div>
          <div>‚Ä¢ "Keyboard navigation" ‚Üí ARIA, focus management, semantic HTML</div>
          <div>‚Ä¢ "Problem-solving" ‚Üí Pivot adaptation, debugging, refactoring</div>
        </div>
      `;

      // Portfolio
      document.getElementById('fitfolioPortfolioHeader').innerHTML = `<div style="font-size: 14px; color: #f0f4f8; line-height: 1.6;">${cand.name} - Public Portfolio</div>`;
      document.getElementById('fitfolioProofTimeline').innerHTML = `
        <div style="font-size: 12px; color: #8899a6; line-height: 1.8;">
          <div style="margin-bottom: 12px;"><strong style="color: #f0f4f8;">Proof 1:</strong> ${challenge} ‚Äî ${score ? score.toFixed(1) : 'In Progress'} (${new Date().toLocaleDateString()})</div>
        </div>
      `;

      document.getElementById('fitfolioModal').classList.add('active');
    }

    function switchFitfolioTab(e, tabId) {
      document.querySelectorAll('#fitfolioTabs .tab').forEach(t => t.classList.remove('active'));
      e.target.classList.add('active');
      document.querySelectorAll('#fitfolioModal .tab-content').forEach(c => c.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
    }

    function copyShareLink() {
      const link = document.getElementById('shareLink');
      navigator.clipboard.writeText(link.value);
      showToast('Link copied!', 'success');
    }

    // ===== RUBRIC MODAL =====
    function openRubricModal(challengeType) {
      const rubricContent = document.getElementById('rubricContent');
      rubricContent.innerHTML = `
        <div style="margin-bottom: 32px;">
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Stack Dimensions (Technical Skills)</div>
          <div style="margin-bottom: 16px;">
            <div style="font-weight: 600; color: #f0f4f8; margin-bottom: 8px;">Correctness & Edge-Case Handling</div>
            <div style="font-size: 13px; color: #8899a6; line-height: 1.6;">
              <div>1. Incomplete ‚Ä¢ Does not handle basic cases</div>
              <div>2. Basic ‚Ä¢ Handles happy path, misses edge cases</div>
              <div>3. Solid ‚Ä¢ Most edge cases handled correctly</div>
              <div>4. Strong ‚Ä¢ Comprehensive handling, minor gaps</div>
              <div>5. Exceptional ‚Ä¢ All cases handled with elegance</div>
            </div>
          </div>
          <div style="margin-bottom: 16px;">
            <div style="font-weight: 600; color: #f0f4f8; margin-bottom: 8px;">Accessibility Quality / Data Quality</div>
            <div style="font-size: 13px; color: #8899a6; line-height: 1.6;">
              <div>1. Poor ‚Ä¢ No ARIA/labels; inaccessible or dirty data</div>
              <div>2. Basic ‚Ä¢ Minimal effort; some ARIA or data issues</div>
              <div>3. Adequate ‚Ä¢ Functional accessibility; reasonable data quality</div>
              <div>4. Strong ‚Ä¢ Good practices; well-structured data</div>
              <div>5. Exemplary ‚Ä¢ Full accessibility; pristine data quality</div>
            </div>
          </div>
          <div>
            <div style="font-weight: 600; color: #f0f4f8; margin-bottom: 8px;">Code Clarity & Organization</div>
            <div style="font-size: 13px; color: #8899a6; line-height: 1.6;">
              <div>1. Unclear ‚Ä¢ Cryptic variable names; no structure</div>
              <div>2. Readable ‚Ä¢ Basic structure; some clarity issues</div>
              <div>3. Clear ‚Ä¢ Well-organized; easy to follow</div>
              <div>4. Very Clear ‚Ä¢ Strong patterns; minimal cognitive load</div>
              <div>5. Crystal Clear ‚Ä¢ Exemplary readability and organization</div>
            </div>
          </div>
        </div>

        <div>
          <div style="font-size: 14px; font-weight: 600; color: #f0f4f8; margin-bottom: 16px;">Trait Dimensions (Soft Skills & Problem-Solving)</div>
          <div style="margin-bottom: 16px;">
            <div style="font-weight: 600; color: #f0f4f8; margin-bottom: 8px;">Ownership</div>
            <div style="font-size: 13px; color: #8899a6; line-height: 1.6;">
              <div>1. Minimal ‚Ä¢ Completes assignment with little care</div>
              <div>2. Basic ‚Ä¢ Follows instructions; limited initiative</div>
              <div>3. Solid ‚Ä¢ Proactive refinements; takes responsibility</div>
              <div>4. Strong ‚Ä¢ Drives quality; anticipates needs</div>
              <div>5. Full Ownership ‚Ä¢ Exceptional quality; deep investment</div>
            </div>
          </div>
          <div style="margin-bottom: 16px;">
            <div style="font-weight: 600; color: #f0f4f8; margin-bottom: 8px;">Problem-Solving Approach</div>
            <div style="font-size: 13px; color: #8899a6; line-height: 1.6;">
              <div>1. Stuck ‚Ä¢ Unable to progress without help</div>
              <div>2. Struggles ‚Ä¢ Makes slow progress; misses obvious solutions</div>
              <div>3. Effective ‚Ä¢ Finds solutions; may miss optimizations</div>
              <div>4. Strong ‚Ä¢ Creative approaches; good trade-off analysis</div>
              <div>5. Creative ‚Ä¢ Novel solutions; expert-level problem decomposition</div>
            </div>
          </div>
          <div>
            <div style="font-weight: 600; color: #f0f4f8; margin-bottom: 8px;">Communication & Documentation</div>
            <div style="font-size: 13px; color: #8899a6; line-height: 1.6;">
              <div>1. Unclear ‚Ä¢ Minimal documentation; hard to understand</div>
              <div>2. Basic ‚Ä¢ Bare-minimum READMEs; vague explanations</div>
              <div>3. Adequate ‚Ä¢ Clear READMEs; explains key decisions</div>
              <div>4. Strong ‚Ä¢ Thoughtful docs; clear trade-off explanations</div>
              <div>5. Articulate ‚Ä¢ Exceptional communication; philosophy shared</div>
            </div>
          </div>
        </div>
      `;
      document.getElementById('rubricModal').classList.add('active');
    }

    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal-overlay')) {
        e.target.classList.remove('active');
      }
    });

    // ===== INVITE MODAL =====
    function openInviteModal(challengeType) {
      const challengeMap = { frontend: 'Frontend React', backend: 'Backend API', data: 'Data Python/SQL' };
      document.getElementById('inviteChallenge').value = challengeMap[challengeType] || '';
      document.getElementById('inviteEmail').value = '';
      document.getElementById('inviteMessage').value = '';
      document.getElementById('inviteModal').classList.add('active');
    }

    function sendInvite() {
      const email = document.getElementById('inviteEmail').value;
      if (!email) {
        showToast('Please enter an email address', 'error');
        return;
      }
      showToast('Invite sent to ' + email, 'success');
      document.getElementById('inviteModal').classList.remove('active');
    }

    // ===== COMPARISON =====
    function addToComparison(id) {
      if (!appState.selectedCandidates.has(id)) {
        appState.selectedCandidates.add(id);
      }
      if (appState.selectedCandidates.size > 3) {
        appState.selectedCandidates.delete(Array.from(appState.selectedCandidates)[0]);
      }
      updateBatchActions();
      showToast('Added to comparison', 'info');
    }

    function showComparisonModal(selectedIds) {
      const compareGrid = document.getElementById('compareGrid');
      compareGrid.innerHTML = '';
      selectedIds.forEach(id => {
        const cand = candidates.find(c => c.id === id);
        const displayName = appState.anonMode ? cand.id : cand.name;
        const scores = appState.candidateScores[id] || {};
        compareGrid.innerHTML += `
          <div class="compare-card">
            <div class="compare-card-header">
              <div style="font-weight: 600; color: #f0f4f8;">${displayName}</div>
              <div style="font-size: 12px; color: #8899a6; margin-top: 4px;">${cand.id}</div>
            </div>
            <div class="compare-row">
              <span class="compare-label">Challenge</span>
              <span class="compare-value">${cand.challenge}</span>
            </div>
            <div class="compare-row">
              <span class="compare-label">Status</span>
              <span class="compare-value">${cand.status}</span>
            </div>
            <div class="compare-row">
              <span class="compare-label">Score</span>
              <span class="compare-value">${cand.score ? cand.score.toFixed(1) : '-'}</span>
            </div>
            <div class="compare-row">
              <span class="compare-label">Commits</span>
              <span class="compare-value">${cand.commits}</span>
            </div>
            <div class="compare-row">
              <span class="compare-label">Lines Changed</span>
              <span class="compare-value">${cand.lines}</span>
            </div>
            <div class="compare-row">
              <span class="compare-label">Verified</span>
              <span class="compare-value">${cand.verified ? '‚úì' : '-'}</span>
            </div>
          </div>
        `;
      });
      document.getElementById('compareModal').classList.add('active');
    }

    // ===== SCORING PAGE =====
    function populateScoringDropdown() {
      const select = document.getElementById('scoringCandidateSelect');
      select.innerHTML = '<option value="">Select a candidate...</option>';
      candidates.forEach(c => {
        const displayName = appState.anonMode ? c.id : c.name;
        select.innerHTML += `<option value="${c.id}">${displayName} - ${c.challenge}</option>`;
      });
      select.addEventListener('change', (e) => {
        if (e.target.value) loadCandidateForScoring(e.target.value);
      });
    }

    function loadCandidateForScoring(id) {
      const cand = candidates.find(c => c.id === id);
      const displayName = appState.anonMode ? cand.id : cand.name;
      document.getElementById('scoringCandidateHeader').style.display = 'flex';
      document.getElementById('scoringAvatar').textContent = cand.avatar;
      document.getElementById('scoringCandidateName').textContent = displayName;
      document.getElementById('scoringChallengeInfo').textContent = `${cand.id} ‚Ä¢ ${cand.challenge} ‚Ä¢ ${cand.status}`;
      document.getElementById('scoringContent').style.display = 'grid';

      // Load previous scores if exist
      const scores = appState.candidateScores[id] || { correctness: 3, accessibility: 3, clarity: 3, ownership: 3, solving: 3, comm: 3 };
      document.getElementById('scoreCorrectness').value = scores.correctness;
      document.getElementById('scoreAccessibility').value = scores.accessibility;
      document.getElementById('scoreClarity').value = scores.clarity;
      document.getElementById('scoreOwnership').value = scores.ownership;
      document.getElementById('solvingScore').value = scores.solving;
      document.getElementById('scoreComm').value = scores.comm;

      updateScorings();

      // Show widener scores if applicable
      if (cand.wideners.length > 0) {
        document.getElementById('widenerScoresDiv').style.display = 'block';
        let widenerHTML = '';
        cand.wideners.forEach(w => {
          widenerHTML += `
            <div class="rubric-dimension">
              <label class="dimension-label">${w}</label>
              <input type="range" class="slider" min="1" max="5" value="3" oninput="updateScorings()">
              <div class="dimension-scale">
                <span>1</span>
                <span style="color: #3b82f6; font-weight: 600;">3</span>
                <span>5</span>
              </div>
            </div>
          `;
        });
        document.getElementById('widenerScoresContainer').innerHTML = widenerHTML;
      } else {
        document.getElementById('widenerScoresDiv').style.display = 'none';
      }
    }

    function updateScorings() {
      const vals = [
        parseFloat(document.getElementById('scoreCorrectness').value),
        parseFloat(document.getElementById('scoreAccessibility').value),
        parseFloat(document.getElementById('scoreClarity').value),
        parseFloat(document.getElementById('scoreOwnership').value),
        parseFloat(document.getElementById('solvingScore').value),
        parseFloat(document.getElementById('scoreComm').value)
      ];

      document.getElementById('correctnessValue').textContent = vals[0];
      document.getElementById('accessibilityValue').textContent = vals[1];
      document.getElementById('clarityValue').textContent = vals[2];
      document.getElementById('ownershipValue').textContent = vals[3];
      document.getElementById('solvingValue').textContent = vals[4];
      document.getElementById('commValue').textContent = vals[5];

      const avg = (vals.reduce((a, b) => a + b, 0) / vals.length).toFixed(1);
      document.getElementById('overallScore').textContent = avg;
    }

    function goToScoring(id) {
      window.location.hash = 'scoring';
      navigateToPage('scoring');
      document.getElementById('scoringCandidateSelect').value = id;
      loadCandidateForScoring(id);
    }

    function saveScoringDraft() {
      showToast('Scoring saved as draft', 'success');
    }

    function generateFitfolio() {
      document.getElementById('fitfolioGenerateModal').classList.add('active');
      showToast('FitFolio generated successfully', 'success');
    }

    function closeFitfolioGenerateModal() {
      document.getElementById('fitfolioGenerateModal').classList.remove('active');
    }

    // ===== CHALLENGE CREATION =====
    function resetChallengeModal() {
      document.getElementById('challengeStep1').style.display = 'block';
      document.getElementById('challengeStep2').style.display = 'none';
      document.getElementById('challengeStep3').style.display = 'none';
      document.getElementById('roleSelect').value = '';
      document.getElementById('focusInput').value = '';
    }

    function closeCreateChallengeModal() {
      document.getElementById('createChallengeModal').classList.remove('active');
      resetChallengeModal();
    }

    function generateChallengeStep2() {
      const role = document.getElementById('roleSelect').value;
      if (!role) {
        showToast('Please select a role', 'error');
        return;
      }
      document.getElementById('challengeStep1').style.display = 'none';
      document.getElementById('challengeStep2').style.display = 'block';
      simulateAIGeneration(role);
    }

    const challengeTemplates = {
      frontend: {
        title: 'Frontend React ‚Äî Search + Accessibility Pivot',
        stack: 'React, TypeScript, CSS',
        brief: 'Build a product list component with client-side search and category filter. The component should handle a dataset of 50+ items with real-time filtering. At minute 60, the pivot is triggered: add full keyboard navigation and ARIA labels for all interactive controls.',
        criteria: '‚Ä¢ Real-time search filters products by name and description\n‚Ä¢ Category filter composes cleanly with search (both active simultaneously)\n‚Ä¢ Keyboard navigation: Tab, Shift+Tab, Enter, Arrow keys work across all controls\n‚Ä¢ ARIA labels on search input, category dropdown, and result list\n‚Ä¢ Basic unit tests for filter logic and debounce function\n‚Ä¢ README documents accessibility decisions and tradeoffs',
        pivot: 'At 60 minutes: "Add keyboard navigation and ARIA labels for all controls. Focus on accessibility best practices. Justify your implementation choices in the README."',
        rubricStack: ['Correctness & edge-case handling', 'Accessibility quality (ARIA, keyboard nav)', 'Code clarity and component structure']
      },
      backend: {
        title: 'Backend API ‚Äî Rate Limiter + Auth Pivot',
        stack: 'Node.js, Express, PostgreSQL',
        brief: 'Design and implement a RESTful API for a task management system with CRUD operations, input validation, and error handling. At minute 60, the pivot is triggered: add token-based rate limiting per user with configurable thresholds.',
        criteria: '‚Ä¢ CRUD endpoints for tasks (create, read, update, delete)\n‚Ä¢ Input validation with clear error messages and proper HTTP status codes\n‚Ä¢ Rate limiter tracks requests per token with sliding window\n‚Ä¢ Configurable rate limits (requests per minute, burst allowance)\n‚Ä¢ Integration tests for happy path and rate limit scenarios\n‚Ä¢ README documents API design decisions',
        pivot: 'At 60 minutes: "Implement token-based rate limiting. Each API token gets 100 requests per minute with a burst allowance of 20. Return 429 with Retry-After header when exceeded."',
        rubricStack: ['API design and REST conventions', 'Rate limiting correctness', 'Error handling and validation quality']
      },
      fullstack: {
        title: 'Full-Stack ‚Äî Real-time Dashboard + WebSocket Pivot',
        stack: 'React, Node.js, WebSocket',
        brief: 'Build a metrics dashboard that displays data from an API with charts and filters. Start with polling-based updates. At minute 60, the pivot is triggered: migrate to WebSocket for real-time streaming updates.',
        criteria: '‚Ä¢ Dashboard displays at least 3 metric types with visual charts\n‚Ä¢ Filters allow narrowing by date range and metric type\n‚Ä¢ WebSocket connection with automatic reconnection on disconnect\n‚Ä¢ Real-time updates reflect in charts within 500ms\n‚Ä¢ Loading states and error boundaries handle edge cases\n‚Ä¢ README compares polling vs WebSocket tradeoffs',
        pivot: 'At 60 minutes: "Replace polling with WebSocket for real-time updates. Handle connection drops gracefully with exponential backoff reconnection. Show connection status indicator."',
        rubricStack: ['Frontend component architecture', 'WebSocket implementation quality', 'Data flow and state management']
      },
      data: {
        title: 'Data Analysis ‚Äî Retention Cohorts + Pivot Redefinition',
        stack: 'Python, SQL, Pandas',
        brief: 'Analyze a CSV of user events to produce a monthly cohort retention chart and 5 key insights. At minute 60, the pivot is triggered: redefine cohorts by first paid event instead of signup date, update all analysis.',
        criteria: '‚Ä¢ Monthly cohort retention table and visualization\n‚Ä¢ 5 concise, actionable insights from the data\n‚Ä¢ Reproducible analysis steps in notebook\n‚Ä¢ Pivot: cohorts redefined by first paid event with delta notes\n‚Ä¢ Clear documentation of methodology and assumptions\n‚Ä¢ At least 1 caveat about data quality or limitations',
        pivot: 'At 60 minutes: "Redefine cohorts by first paid event instead of first seen. Update the retention chart. Note what changed and what stayed the same."',
        rubricStack: ['Data cleaning and analysis quality', 'Visualization clarity', 'Insight depth and actionability']
      },
      devops: {
        title: 'Infrastructure ‚Äî CI Pipeline + Rollback Pivot',
        stack: 'Docker, GitHub Actions, Terraform',
        brief: 'Set up a CI/CD pipeline for a microservice: containerize the app, write a multi-stage Dockerfile, and create GitHub Actions workflow for build/test/deploy. At minute 60, add automated rollback on health check failure.',
        criteria: '‚Ä¢ Multi-stage Dockerfile with optimized image size\n‚Ä¢ GitHub Actions workflow: lint, test, build, deploy stages\n‚Ä¢ Health check endpoint and automated verification\n‚Ä¢ Rollback mechanism triggers on failed health check\n‚Ä¢ Pipeline runs in under 5 minutes end-to-end\n‚Ä¢ README documents deployment strategy and rollback behavior',
        pivot: 'At 60 minutes: "Add automated rollback. If the health check fails within 2 minutes of deployment, automatically revert to the previous version and alert via webhook."',
        rubricStack: ['Container and pipeline design', 'Rollback mechanism correctness', 'Infrastructure-as-code quality']
      },
      'ai-ml': {
        title: 'AI/ML ‚Äî Classification Pipeline + Drift Detection Pivot',
        stack: 'Python, scikit-learn, Pandas',
        brief: 'Build a text classification pipeline: data preprocessing, feature extraction, model training, and evaluation. At minute 60, add a data drift detection module that flags when incoming data distribution shifts beyond a configurable threshold.',
        criteria: '‚Ä¢ End-to-end classification pipeline with train/test split\n‚Ä¢ At least 2 model comparisons with metrics (precision, recall, F1)\n‚Ä¢ Drift detector uses statistical test (KS, PSI, or chi-squared)\n‚Ä¢ Configurable threshold with clear alerting mechanism\n‚Ä¢ Notebook documents model selection rationale\n‚Ä¢ Reproducible with pinned dependencies',
        pivot: 'At 60 minutes: "Add drift detection. Monitor incoming feature distributions against training data. Flag drift when PSI > 0.2 or KS test p-value < 0.05. Log drift reports."',
        rubricStack: ['ML pipeline correctness', 'Drift detection implementation', 'Evaluation methodology and documentation']
      }
    };

    function simulateAIGeneration(role) {
      const template = challengeTemplates[role];
      if (!template) return;

      const statusTexts = [
        'Analyzing role requirements',
        'Designing challenge brief',
        'Calibrating difficulty for seniority',
        'Generating acceptance criteria',
        'Crafting pivot specification',
        'Building rubric dimensions',
        'Finalizing challenge'
      ];
      let statusIndex = 0;
      const statusInterval = setInterval(() => {
        statusIndex++;
        if (statusIndex < statusTexts.length) {
          document.getElementById('aiStatusText').textContent = statusTexts[statusIndex];
        }
      }, 400);

      setTimeout(() => {
        clearInterval(statusInterval);
        const focus = document.getElementById('focusInput').value;
        const duration = document.getElementById('durationSelect').value;
        const stipend = duration === '120' ? '$100' : '$150';
        const timeCap = duration + ' min';

        let title = template.title;
        if (focus) {
          title = title.split('‚Äî')[0].trim() + ' ‚Äî ' + focus.charAt(0).toUpperCase() + focus.slice(1) + ' Focus';
        }
        document.getElementById('genTitle').value = title;
        document.getElementById('genStack').value = template.stack;
        document.getElementById('genMeta').value = timeCap + ' ‚Ä¢ ' + stipend + ' stipend';
        document.getElementById('genBrief').value = template.brief;
        document.getElementById('genCriteria').value = template.criteria;
        document.getElementById('genPivot').value = template.pivot;

        const rubricEl = document.getElementById('genRubricStack');
        rubricEl.innerHTML = template.rubricStack.map(d => '<div>‚Ä¢ ' + d + '</div>').join('');

        document.getElementById('challengeStep2').style.display = 'none';
        document.getElementById('challengeStep3').style.display = 'block';
      }, 2800);
    }

    function publishChallenge() {
      showToast('Challenge published successfully', 'success');
      closeCreateChallengeModal();
    }

    // ===== LIVE SESSION SIMULATION =====
    function startSimulation() {
      if (appState.isProfRunning) return;
      appState.isProfRunning = true;
      document.getElementById('startSimBtn').style.display = 'none';
      document.getElementById('pauseSimBtn').style.display = 'block';

      appState.simulationInterval = setInterval(() => {
        appState.proofTime += 0.4;
        if (appState.proofTime > 120) {
          appState.proofTime = 120;
          clearInterval(appState.simulationInterval);
          showProofCompleted();
          appState.isProfRunning = false;
          document.getElementById('startSimBtn').style.display = 'block';
          document.getElementById('pauseSimBtn').style.display = 'none';
          return;
        }

        updateLiveSession();
      }, 100);
    }

    function pauseSimulation() {
      appState.isProfRunning = false;
      clearInterval(appState.simulationInterval);
      document.getElementById('startSimBtn').style.display = 'block';
      document.getElementById('pauseSimBtn').style.display = 'none';
    }

    function resetSimulation() {
      appState.proofTime = 0;
      appState.isProfRunning = false;
      clearInterval(appState.simulationInterval);
      document.getElementById('startSimBtn').style.display = 'block';
      document.getElementById('pauseSimBtn').style.display = 'none';
      updateLiveSession();
    }

    function updateLiveSession() {
      const timeRem = 120 - appState.proofTime;
      document.getElementById('liveTimeRemaining').textContent = Math.max(0, Math.ceil(timeRem)) + 'm';

      const currentCommitIdx = commits.findIndex(c => c.time > appState.proofTime) - 1;
      const displayedCommits = commits.slice(0, Math.max(1, currentCommitIdx + 1));

      let totalLines = 0;
      let totalFiles = new Set();
      displayedCommits.forEach(c => {
        if (!c.isPivot) {
          totalLines += c.lines;
          totalFiles.add(c.files);
        }
      });

      document.getElementById('liveCommitCount').textContent = displayedCommits.length - (displayedCommits.some(c => c.isPivot) ? 1 : 0);
      document.getElementById('liveLineCount').textContent = totalLines;
      document.getElementById('liveFileCount').textContent = totalFiles.size;

      const testCov = Math.min(100, appState.proofTime * 0.8);
      document.getElementById('liveTestCoverage').style.width = testCov + '%';
      document.getElementById('liveTestCoverageText').textContent = Math.round(testCov) + '%';

      const phase = appState.proofTime >= 60 ? 'Post-Pivot' : 'Pre-Pivot';
      document.getElementById('livePhase').textContent = phase;

      const feed = document.getElementById('commitFeed');
      feed.innerHTML = '';
      displayedCommits.forEach(commit => {
        const item = document.createElement('div');
        item.className = 'commit-item' + (commit.isPivot ? ' pivot-marker' : '');
        const statsText = !commit.isPivot ? `+${commit.lines} lines ‚Ä¢ ${commit.files} files` : '';
        item.innerHTML = `
          <div class="commit-marker"></div>
          <div class="commit-content">
            ${commit.isPivot ? '<div class="pivot-label">üîÑ Pivot Triggered</div>' : ''}
            <div class="commit-time">${commit.time}m</div>
            <div class="commit-msg">${commit.msg}</div>
            <div class="commit-stats">${statsText}</div>
          </div>
        `;
        feed.appendChild(item);
      });
    }

    function showProofCompleted() {
      const feed = document.getElementById('commitFeed');
      feed.innerHTML = `
        <div style="padding: 32px; text-align: center; background: rgba(78, 205, 196, 0.1); border-radius: 8px;">
          <div style="font-size: 48px; margin-bottom: 16px;">‚úì</div>
          <div style="font-size: 18px; font-weight: 700; color: #f0f4f8; margin-bottom: 8px;">Proof Completed</div>
          <div style="font-size: 13px; color: #8899a6; margin-bottom: 24px;">19 commits ‚Ä¢ 1,247 lines ‚Ä¢ 100% test coverage ‚Ä¢ Pivot handled perfectly</div>
          <div class="verified-badge" style="display: inline-block; margin-bottom: 24px;">‚úì VERIFIED CRAFT</div>
          <button class="btn-primary" onclick="window.location.hash='scoring'">Proceed to Scoring ‚Üí</button>
        </div>
      `;
    }

    // ===== SETTINGS PAGE =====
    function showInviteMemberModal() {
      const email = prompt('Enter team member email:');
      if (email) {
        showToast('Invitation sent to ' + email, 'success');
      }
    }

    // ===== INITIALIZE PAGE =====
    renderCandidatesTable();
    updateLiveSession();

    // Prevent modal overlay clicks from propagating
    document.querySelectorAll('.modal-overlay').forEach(overlay => {
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          overlay.classList.remove('active');
        }
      });
    });
  </script>
</body>
</html>
